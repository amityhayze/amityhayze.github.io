<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Amity Hayze â€” Interactive CRT Visualizer</title>
<style>
  :root {
    --bg-dark: #000;
    --neon: #00f0ff;
    --panel: rgba(0,0,0,0.7);
    --hazy-pink: rgba(255,107,205,0.25);
  }
  * { box-sizing: border-box; margin:0; padding:0;}
  body { background:#000; font-family:"Courier New", monospace; color:var(--neon); overflow:hidden;}
  canvas { display:block; position:absolute; top:0; left:0; width:100%; height:100%; }
  .tv-panel {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    background:var(--panel); border:2px solid var(--neon);
    border-radius:14px; padding:20px; width:480px; max-width:90%;
    display:flex; flex-direction:column; align-items:center; gap:16px;
    box-shadow:0 0 40px rgba(0,240,255,0.15);
  }
  .knobs { display:flex; justify-content:space-around; width:100%; }
  .knob-container { display:flex; flex-direction:column; align-items:center; gap:6px; }
  input[type=range] { -webkit-appearance:none; width:80px; background:transparent; }
  input[type=range]::-webkit-slider-thumb { -webkit-appearance:none; height:16px; width:16px; background:var(--neon); border-radius:50%; cursor:pointer; }
  input[type=range]::-webkit-slider-runnable-track { height:4px; background:rgba(0,255,255,0.2); border-radius:2px; }
  .label { font-size:12px; text-transform:uppercase; color:var(--neon); }
</style>
</head>
<body>
<canvas id="crtCanvas"></canvas>

<div class="tv-panel">
  <h2 style="color:var(--neon); text-shadow:0 0 10px var(--neon);">CRT Visualizer Room</h2>
  <audio id="music" src="Cascade Canyon.mp3" controls autoplay loop></audio>
  <div class="knobs">
    <div class="knob-container">
      <label class="label" for="colorKnob">Color Shift</label>
      <input type="range" id="colorKnob" min="0" max="360" value="0">
    </div>
    <div class="knob-container">
      <label class="label" for="pulseKnob">Pulse Speed</label>
      <input type="range" id="pulseKnob" min="0" max="5" step="0.1" value="1">
    </div>
    <div class="knob-container">
      <label class="label" for="glitchKnob">Glitch Intensity</label>
      <input type="range" id="glitchKnob" min="0" max="15" step="1" value="2">
    </div>
  </div>
</div>

<script>
const canvas = document.getElementById('crtCanvas');
const ctx = canvas.getContext('2d');
let cw, ch;
function resize(){ cw=canvas.width=window.innerWidth; ch=canvas.height=window.innerHeight; }
window.addEventListener('resize', resize);
resize();

// knobs
const colorKnob=document.getElementById('colorKnob');
const pulseKnob=document.getElementById('pulseKnob');
const glitchKnob=document.getElementById('glitchKnob');
let colorShift=0, pulseSpeed=1, glitchIntensity=2;
colorKnob.addEventListener('input', e=>colorShift=e.target.value);
pulseKnob.addEventListener('input', e=>pulseSpeed=e.target.value);
glitchKnob.addEventListener('input', e=>glitchIntensity=e.target.value);

// audio
const audio=document.getElementById('music');
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
const src=audioCtx.createMediaElementSource(audio);
const analyser=audioCtx.createAnalyser();
src.connect(analyser);
analyser.connect(audioCtx.destination);
analyser.fftSize=256;
const bufferLength=analyser.frequencyBinCount;
const dataArray=new Uint8Array(bufferLength);

// CRT effect
function drawCRT(){
  ctx.clearRect(0,0,cw,ch);
  analyser.getByteFrequencyData(dataArray);
  const avg = dataArray.reduce((a,b)=>a+b,0)/dataArray.length;
  // neon pulse
  ctx.fillStyle=`hsl(${colorShift},100%,50%)`;
  const radius = 50 + avg*pulseSpeed*0.4;
  ctx.beginPath();
  ctx.arc(cw/2,ch/2,radius,0,Math.PI*2);
  ctx.fill();

  // glitch overlay
  if(Math.random()<glitchIntensity*0.02){
    const x=Math.random()*cw, y=Math.random()*ch;
    ctx.fillStyle='rgba(255,255,255,0.05)';
    ctx.fillRect(x,y,Math.random()*50,Math.random()*10);
  }

  // CRT scan lines
  ctx.fillStyle='rgba(0,255,255,0.02)';
  for(let i=0;i<ch;i+=2){
    ctx.fillRect(0,i,cw,1);
  }

  requestAnimationFrame(drawCRT);
}
drawCRT();

// EASTER EGGS
let easterEggTimers={combo1:0};
function checkEasterEggs(){
  if(colorShift>300 && pulseSpeed>4){
    easterEggTimers.combo1++;
    if(easterEggTimers.combo1>120){ activateHazyPinkMode(); easterEggTimers.combo1=0; }
  } else easterEggTimers.combo1=0;

  if(!window.glitchSequence) window.glitchSequence=[];
  window.glitchSequence.push(glitchIntensity);
  if(window.glitchSequence.length>60) window.glitchSequence.shift();
  if(window.glitchSequence[0]==0 && window.glitchSequence[29]>=10 && window.glitchSequence[59]==0){
    activateGlitchMode();
    window.glitchSequence=[];
  }

  requestAnimationFrame(checkEasterEggs);
}
checkEasterEggs();

function activateHazyPinkMode(){ canvas.style.filter='hue-rotate(320deg) saturate(1.5)'; setTimeout(()=>canvas.style.filter='',3000);}
function activateGlitchMode(){ glitchIntensity=15; setTimeout(()=>glitchIntensity=2,3000);}
</script>
</body>
</html>
